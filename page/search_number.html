<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html lang="zh-tw">
	<body>
		<div class="tab-content">
			<div id="home" class="tab-pane fade in active">
				<div id="home_toolbar">
					<div class="col-auto">
						<button type="button" class="btn btn-primary" onclick="upd_partnum_table()" >更新數據</button>
					</div>
				</div>
				<table id="part_table"
					data-toggle="table"
					data-click-to-select="true"
					data-side-pagination="client"
					data-pagination="true"
					data-height="525"
					data-page-list="[5, 10, 50, 100]"
					data-search="true"
					data-id-field="index"
					data-unique-id="index"
					data-show-columns="true"
					data-show-export="true"
					data-row-style="set_table_font"
					data-toolbar="#home_toolbar">
					<thead>
						<tr>
							<th data-field="index">項次</th>
							<th data-field="number" data-formatter="guide_num_format" data-events="guide_event_response">品號</th>
							<th data-field="name">品名</th>
							<th data-field="format">規格</th>
							<th data-field="fignum">圖號</th>
							<th data-field="supplier" data-formatter="guide_supplier_format" data-events="guide_event_response" >廠商</th>
							<th data-field="unit">單位</th>
							<th data-field="stock_quantity">庫存數量</th>
							<th data-field="cost">單位成本</th>
							<th data-field="stock_amount">庫存金額</th>
						</tr>
					</thead>
				</table>					
			</div>
		</div>
	</body>
	<script language="JavaScript">
		var body = $("body");
		var username;
		
		$(document).on({
			ajaxStart: function() { body.addClass("loading"); },
			ajaxStop: function() { body.removeClass("loading"); }
		});
		
		
		function guide_num_format( val ){
			return ("<a class='guide_part_number' href='javascript:void(0)' >" + val + "</a>");
		}
		
		function guide_supplier_format( val ){
			return ("<a class='guide_part_supplier' href='javascript:void(0)' >" + val + "</a>");
		}
		
		window.guide_event_response = {
			'click .guide_part_number': function (e, value, row, index) {
				chenge_page_to_bom( value );
			},
			'click .guide_part_supplier': function (e, value, row, index) {
				chenge_page_to_supplier( value );
			},
		};
		
		
		$(document).ready(function(){
			var url = location.href;
			var temp = url.split("?");
			username = temp[1];
			upd_partnum_table();
		});
		
		
		function upd_partnum_table(){
			var info = {
				"id": username,
				"tabID": $("#part_table")
			};
			receive_db_info( info );
		}
		
	</script>
</html>
