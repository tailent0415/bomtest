<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html lang="zh-tw">
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.css">
		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="/css/style.css">
		<script src="/CoreScripts/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/extensions/multiple-search/bootstrap-table-multiple-search.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-zh-TW.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-zh-TW.min.js"></script>
		<script src="/CoreScripts/bootstrap-table-export.js"></script>
		<script src="/CoreScripts/tableExport.js"></script>
	</head>
	<body>
		<div class="load_modal"></div>
		<div class="page_container">
			<div>
				<div id="home_toolbar">
					<div class="col-auto">
						<button type="button" class="btn btn-primary" onclick="receive_db_info()" >更新數據</button>
					</div>
				</div>
				<table id="part_table"
					data-toggle="table"
					data-click-to-select="true"
					data-side-pagination="client"
					data-pagination="true"
					data-page-list="[10, 50, 100]"
					data-search="true"
					data-id-field="index"
					data-unique-id="index"
					data-show-columns="true"
					data-show-export="true"
					data-row-style="set_table_font"
					data-toolbar="#home_toolbar">
					<thead>
						<tr>
							<th data-field="index">項次</th>
							<th data-field="number" data-formatter="guide_num_format" data-events="guide_event_response">品號</th>
							<th data-field="name">品名</th>
							<th data-field="format">規格</th>
							<th data-field="fignum">圖號</th>
							<th data-field="supplier" data-formatter="guide_supplier_format" data-events="guide_event_response" >廠商</th>
							<th data-field="unit">單位</th>
							<th data-field="stock_quantity">庫存數量</th>
							<th data-field="cost">單位成本</th>
							<th data-field="stock_amount">庫存金額</th>
						</tr>
					</thead>
				</table>					
			</div>
		</div>
		<script language="JavaScript">
			var body = $("body");
			var username;
			$(document).on({
				ajaxStart: function(){
					body.addClass("loading");
				},
				ajaxStop: function(){ 
					body.removeClass("loading");
				}
			});
			
			function guide_num_format( val ){
				return ("<a class='guide_part_number' href='javascript:void(0)' >" + val + "</a>");
			}
			
			function guide_supplier_format( val ){
				return ("<a class='guide_part_supplier' href='javascript:void(0)' >" + val + "</a>");
			}
			
			window.guide_event_response = {
				'click .guide_part_number': function (e, value, row, index) {
					chenge_page_to_bom( value );
				},
				'click .guide_part_supplier': function (e, value, row, index) {
					chenge_page_to_supplier( value );
				},
			};
			
			$(document).ready(function(){
				username = sessionStorage.getItem("login_id");
				sessionStorage.setItem( "table_id", $("#part_table") );
				receive_db_info();
				$('#part_table').bootstrapTable({ height: $(window).height() - 120 });
			});
			
		</script>
		<script type="text/javascript" src="/SubScripts/db_receive.js"></script>
		<script type="text/javascript" src="/SubScripts/db_send.js"></script>
		<script type="text/javascript" src="/SubScripts/macro_receive.js"></script>
		<script type="text/javascript" src="/SubScripts/set_table_style.js"></script>
	</body>
</html>
