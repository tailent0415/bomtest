<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html lang="zh-tw">
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.css">
		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="/css/style.css">
		<script src="/CoreScripts/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/extensions/multiple-search/bootstrap-table-multiple-search.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-zh-TW.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-zh-TW.min.js"></script>
	</head>
	<body>
		<datalist id="part_list" class="normal_font"></datalist>
		<div id="bom_cnt" class="page_container">
		</div>
		<script language="JavaScript">
			var body = $("body");
			var element_refnum = "bom_cnt";
			var bom_node_array = new Array();
			
			$(document).on({
				ajaxStart: function(){
					body.addClass("loading");
				},
				ajaxStop: function(){ 
					body.removeClass("loading");
				}
			});

			$(document).ready(function(){
				body.addClass("loading");
				var part_list_options = sessionStorage.getItem( "part_options" );
				$("#part_list").empty();
				$("#part_list").append( part_list_options );
				init_bomtable_interface();
				setTimeout(function() { 
					body.removeClass("loading"); 
				}, 1000);
			});
			
			// Init Bomtable interface
			function init_bomtable_interface(){
				bom_node_array = [];
				var cnt = document.getElementById( element_refnum );
				var div_first_obj = document.getElementById( "bom" );
				if( div_first_obj !== null ){
					remove_bomtable_interface();
				}
				div_first_obj = document.createElement( "div" );
				div_first_obj.id = "bom"
				div_first_obj.setAttribute("class", "tab_form");
				cnt.appendChild(div_first_obj);
				var div_second_obj = document.createElement( "div" );
				div_second_obj.setAttribute("class", "text_field");
				var data_str = '<label for="part_num_in">品號 : </label><input id="part_num_in" class="part_attr input_container part_list_style normal_font" name="part_num_list" list="part_list" onchange="update_bomtable_type( this.value, -1 )"/>';
				div_second_obj.innerHTML = data_str;
				div_first_obj.appendChild(div_second_obj);
			}



		</script>
		<script type="text/javascript" src="/SubScripts/db_send.js"></script>
		<script type="text/javascript" src="/SubScripts/macro_send.js"></script>
		<script type="text/javascript" src="/SubScripts/db_receive.js"></script>
		<script type="text/javascript" src="/SubScripts/macro_receive.js"></script>
		<script type="text/javascript" src="/SubScripts/part_number.js"></script>
		<script type="text/javascript" src="/SubScripts/get.js"></script>
		<script type="text/javascript" src="/SubScripts/ctrl_table.js"></script>
		<script type="text/javascript" src="/SubScripts/response_button.js"></script>
	</body>
</html>
